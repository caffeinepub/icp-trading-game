{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Implement user registration process",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Create a registration form component that collects user display name and validates input before account creation",
      "acceptanceCriteria": [
        "Registration form appears for new users after Internet Identity authentication",
        "Form includes display name input field with validation",
        "Form has clear submit and cancel actions",
        "Input validation prevents empty or invalid display names",
        "Form shows loading state during submission"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/RegistrationForm.tsx",
          "operation": "create",
          "description": "Create a registration form component with display name input, validation logic (minimum 2 characters, maximum 50 characters, no empty strings), submit/cancel buttons, loading states, and error handling. The form should use shadcn/ui components (Card, Input, Button) for consistent styling with the existing application. Include form state management with controlled inputs and validation feedback."
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Update App.tsx to integrate registration flow between Internet Identity login and main application access",
      "acceptanceCriteria": [
        "After successful Internet Identity login, check if user account exists",
        "If no account exists, display registration form before main app",
        "After successful registration, proceed to main trading application",
        "Handle registration errors with clear user feedback",
        "Existing users bypass registration and go directly to trading interface"
      ],
      "file_operations": [
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Add registration flow orchestration after Internet Identity authentication. Check if user has completed registration by calling getCallerUserProfile(). If profile is null, display the RegistrationForm component. After successful registration, refresh the profile query and proceed to the main trading interface. Handle registration states (checking, showing form, registered) and display appropriate loading states. Preserve existing authentication flow, account initialization logic, error alerts, and tabbed navigation. The authorization component requires profile setup, so integrate registration before the main app loads."
        },
        {
          "path": "frontend/src/hooks/useRegistration.ts",
          "operation": "create",
          "description": "Create a custom hook that provides registration functionality using React Query mutation. Call the backend registerUser(displayName: string) method and handle success/error states. On successful registration, invalidate the 'currentUserProfile' query to refresh the profile data. Return mutation state (isLoading, isError, error, mutate) for use in the RegistrationForm component."
        }
      ]
    },
    {
      "id": "REQ-4",
      "summary": "Add registration success confirmation with welcome message and account details before entering the trading application",
      "acceptanceCriteria": [
        "Display welcome message with user's display name after registration",
        "Show starting cash balance ($10,000) confirmation",
        "Provide clear call-to-action to proceed to trading",
        "Success state transitions smoothly to main application"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/RegistrationSuccess.tsx",
          "operation": "create",
          "description": "Create a success confirmation component displaying a welcome message with the user's display name, the starting cash balance of $10,000, and a call-to-action button to proceed to the trading application. Use shadcn/ui Card component for consistent styling. Include celebratory design elements (success icon, positive color scheme) to create a welcoming experience."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Add registration success state management to App.tsx. After successful registration (when useRegistration mutation succeeds), show the RegistrationSuccess component with the display name from the form. Provide a handler to dismiss the success screen and transition to the main trading interface. Maintain state to track: not-registered (show form), registration-success (show success screen), registered (show main app)."
        }
      ]
    }
  ]
}